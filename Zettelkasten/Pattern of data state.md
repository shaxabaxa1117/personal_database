	–î–µ–Ω—å : 2025-02-22 
–í—Ä–µ–º—è : 14-37

Status : #Programming  


# üë®‚ÄçüíªPattern of data state


### –ß—Ç–æ —ç—Ç–æ —Ç–∞–∫–æ–µ?

  

–ü—Ä–µ–¥—Å—Ç–∞–≤—å, —á—Ç–æ —É —Ç–µ–±—è –µ—Å—Ç—å –∫–æ—Ä–æ–±–∫–∞, –≤ –∫–æ—Ç–æ—Ä–æ–π —Ç—ã —Ö—Ä–∞–Ω–∏—à—å —Å–≤–æ–∏ –∏–≥—Ä—É—à–∫–∏. –ò–Ω–æ–≥–¥–∞ –≤ –∫–æ—Ä–æ–±–∫–µ –ª–µ–∂–∏—Ç –∏–≥—Ä—É—à–∫–∞, –∫–æ—Ç–æ—Ä—É—é —Ç—ã —Ö–æ—Ç–µ–ª (–Ω–∞–ø—Ä–∏–º–µ—Ä, –º–∞—à–∏–Ω–∫–∞), –∞ –∏–Ω–æ–≥–¥–∞ —Ç–∞–º –æ–∫–∞–∑—ã–≤–∞–µ—Ç—Å—è –∑–∞–ø–∏—Å–∫–∞, —á—Ç–æ –∏–≥—Ä—É—à–∫–∏ —Å–ª–æ–º–∞–ª–∏—Å—å –∏–ª–∏ –ø–æ—Ç–µ—Ä—è–ª–∏—Å—å. –≠—Ç–æ—Ç –∫–æ–¥ ‚Äî —ç—Ç–æ –∫–∞–∫ —Ç–∞–∫–∞—è –∫–æ—Ä–æ–±–∫–∞, —Ç–æ–ª—å–∫–æ –¥–ª—è –∫–æ–º–ø—å—é—Ç–µ—Ä–∞. –û–Ω –ø–æ–º–æ–≥–∞–µ—Ç –ø–æ–Ω—è—Ç—å: –≤—Å—ë –ø–æ–ª—É—á–∏–ª–æ—Å—å —Ö–æ—Ä–æ—à–æ (–∏–≥—Ä—É—à–∫–∞ –µ—Å—Ç—å) –∏–ª–∏ —á—Ç–æ-—Ç–æ –ø–æ—à–ª–æ –Ω–µ —Ç–∞–∫ (–∏–≥—Ä—É—à–∫–∞ —Å–ª–æ–º–∞–ª–∞—Å—å).

  

–≠—Ç–æ—Ç –∫–æ–¥ –Ω–∞–∑—ã–≤–∞–µ—Ç—Å—è **–ø–∞—Ç—Ç–µ—Ä–Ω —Å–æ—Å—Ç–æ—è–Ω–∏—è –¥–∞–Ω–Ω—ã—Ö** (Data State). –û–Ω –∫–∞–∫ –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏—è –¥–ª—è –ø—Ä–æ–≥—Ä–∞–º–º—ã: "–°–∫–∞–∂–∏ –º–Ω–µ, —á—Ç–æ —É —Ç–µ–±—è –µ—Å—Ç—å ‚Äî –¥–∞–Ω–Ω—ã–µ –∏–ª–∏ –æ—à–∏–±–∫–∞?"



---
### –†–∞–∑–±–µ—Ä—ë–º –ø–æ —á–∞—Å—Ç—è–º


#### 1. abstract class DataState T


–≠—Ç–æ –∫–∞–∫ –ø–∞–ø–∞ –≤—Å–µ—Ö –∫–æ—Ä–æ–±–æ–∫. –û–Ω –≥–æ–≤–æ—Ä–∏—Ç: "–ö–∞–∂–¥–∞—è –∫–æ—Ä–æ–±–∫–∞ –¥–æ–ª–∂–Ω–∞ —Å–∫–∞–∑–∞—Ç—å, —á—Ç–æ –≤ –Ω–µ–π ‚Äî –∏–≥—Ä—É—à–∫–∞ (data) –∏–ª–∏ –ø—Ä–æ–±–ª–µ–º–∞ (error)". –ë—É–∫–≤–∞ T ‚Äî —ç—Ç–æ –∫–∞–∫ –Ω–∞–∫–ª–µ–π–∫–∞, –∫–æ—Ç–æ—Ä–∞—è –≥–æ–≤–æ—Ä–∏—Ç, –∫–∞–∫–∞—è –∏–º–µ–Ω–Ω–æ –∏–≥—Ä—É—à–∫–∞ –¥–æ–ª–∂–Ω–∞ –±—ã—Ç—å –≤ –∫–æ—Ä–æ–±–∫–µ (–º–∞—à–∏–Ω–∫–∞, –∫—É–∫–ª–∞ –∏–ª–∏ —á—Ç–æ-—Ç–æ –µ—â—ë).

  

- final T? data ‚Äî —ç—Ç–æ –º–µ—Å—Ç–æ –¥–ª—è –∏–≥—Ä—É—à–∫–∏. –ï—Å–ª–∏ –∏–≥—Ä—É—à–∫–∞ –µ—Å—Ç—å, –æ–Ω–∞ —Ç—É—Ç –ª–µ–∂–∏—Ç. –ï—Å–ª–∏ –Ω–µ—Ç, —Ç–∞–º –ø—É—Å—Ç–æ (null).
  
- final DioException? error ‚Äî —ç—Ç–æ –∑–∞–ø–∏—Å–∫–∞, –≥–¥–µ –Ω–∞–ø–∏—Å–∞–Ω–æ, —á—Ç–æ —Å–ª—É—á–∏–ª–æ—Å—å, –µ—Å–ª–∏ –∏–≥—Ä—É—à–∫–∏ –Ω–µ—Ç (–Ω–∞–ø—Ä–∏–º–µ—Ä, "–°–ª–æ–º–∞–ª–æ—Å—å!").
  

abstract –∑–Ω–∞—á–∏—Ç, —á—Ç–æ —ç—Ç–æ –ø—Ä–æ—Å—Ç–æ –æ–±—â–∏–π –ø–ª–∞–Ω, –∞ –Ω–∞—Å—Ç–æ—è—â–∏–µ –∫–æ—Ä–æ–±–∫–∏ –±—É–¥—É—Ç —á—É—Ç—å –Ω–∏–∂–µ.

  

#### 2. class DataSuccess T extends DataState T

  

–≠—Ç–æ –∫–æ—Ä–æ–±–∫–∞ —Å –∏–≥—Ä—É—à–∫–æ–π! –ö–æ–≥–¥–∞ –≤—Å—ë –ø–æ–ª—É—á–∏–ª–æ—Å—å, –º—ã –∫–ª–∞–¥—ë–º –∏–≥—Ä—É—à–∫—É –≤–Ω—É—Ç—Ä—å –∏ –≥–æ–≤–æ—Ä–∏–º: "–£—Ä–∞, –≤–æ—Ç —Ç–≤–æ—è –º–∞—à–∏–Ω–∫–∞!". –ó–¥–µ—Å—å –µ—Å—Ç—å —Ç–æ–ª—å–∫–æ data (–∏–≥—Ä—É—à–∫–∞), –∞ error –æ—Å—Ç–∞—ë—Ç—Å—è –ø—É—Å—Ç—ã–º.

  

- const DataSuccess(T data) : super(data: data); ‚Äî —ç—Ç–æ –∑–Ω–∞—á–∏—Ç, —á—Ç–æ –º—ã –±–µ—Ä—ë–º –∏–≥—Ä—É—à–∫—É –∏ –∫–ª–∞–¥—ë–º –µ—ë –≤ –∫–æ—Ä–æ–±–∫—É.
  

#### 3. class DataFailed T extends DataState T

  

–≠—Ç–æ –∫–æ—Ä–æ–±–∫–∞ —Å –ø–ª–æ—Ö–∏–º–∏ –Ω–æ–≤–æ—Å—Ç—è–º–∏. –ï—Å–ª–∏ –∏–≥—Ä—É—à–∫–∞ –ø–æ—Ç–µ—Ä—è–ª–∞—Å—å –∏–ª–∏ —Å–ª–æ–º–∞–ª–∞—Å—å, –º—ã –∫–ª–∞–¥—ë–º –≤ –∫–æ—Ä–æ–±–∫—É –∑–∞–ø–∏—Å–∫—É –æ–± –æ—à–∏–±–∫–µ (DioException). –ó–¥–µ—Å—å –Ω–µ—Ç –∏–≥—Ä—É—à–∫–∏ (data –ø—É—Å—Ç–æ–µ), –∑–∞—Ç–æ –µ—Å—Ç—å –æ–±—ä—è—Å–Ω–µ–Ω–∏–µ, —á—Ç–æ –ø–æ—à–ª–æ –Ω–µ —Ç–∞–∫.

  

- const DataFailed(DioException error) : super(error: error); ‚Äî –∫–ª–∞–¥—ë–º –∑–∞–ø–∏—Å–∫—É —Å –æ—à–∏–±–∫–æ–π –≤ –∫–æ—Ä–æ–±–∫—É.
  

---

### –ì–¥–µ —ç—Ç–æ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è?

  

–≠—Ç–æ—Ç –∫–æ–¥ —á–∞—Å—Ç–æ –∏—Å–ø–æ–ª—å–∑—É—é—Ç, –∫–æ–≥–¥–∞ –ø—Ä–æ–≥—Ä–∞–º–º–∞ —Ö–æ–¥–∏—Ç –≤ –∏–Ω—Ç–µ—Ä–Ω–µ—Ç, —á—Ç–æ–±—ã –≤–∑—è—Ç—å —á—Ç–æ-—Ç–æ –ø–æ–ª–µ–∑–Ω–æ–µ (–Ω–∞–ø—Ä–∏–º–µ—Ä, –∫–∞—Ä—Ç–∏–Ω–∫–∏, —Ç–µ–∫—Å—Ç –∏–ª–∏ —Å–ø–∏—Å–æ–∫ –¥—Ä—É–∑–µ–π). –ú—ã –∏—Å–ø–æ–ª—å–∑—É–µ–º –±–∏–±–ª–∏–æ—Ç–µ–∫—É Dio (–æ–Ω–∞ –∫–∞–∫ –ø–æ—á—Ç–∞–ª—å–æ–Ω), —á—Ç–æ–±—ã –ø–æ–ø—Ä–æ—Å–∏—Ç—å –¥–∞–Ω–Ω—ã–µ. –ù–æ –∏–Ω–æ–≥–¥–∞ –ø–æ—á—Ç–∞–ª—å–æ–Ω –ø—Ä–∏–Ω–æ—Å–∏—Ç –ø–æ—Å—ã–ª–∫—É (–¥–∞–Ω–Ω—ã–µ), –∞ –∏–Ω–æ–≥–¥–∞ –≥–æ–≤–æ—Ä–∏—Ç: "–ò–∑–≤–∏–Ω–∏, –ø–æ—Å—ã–ª–∫–∞ –ø–æ—Ç–µ—Ä—è–ª–∞—Å—å" (–æ—à–∏–±–∫–∞).

  

–ü—Ä–∏–º–µ—Ä:

  

- –¢—ã –ø—Ä–æ—Å–∏—à—å —É –ø—Ä–æ–≥—Ä–∞–º–º—ã: "–î–∞–π –º–Ω–µ —Å–ø–∏—Å–æ–∫ –º–æ–∏—Ö –ª—é–±–∏–º—ã—Ö –º—É–ª—å—Ç–∏–∫–æ–≤!"
  
- –ü—Ä–æ–≥—Ä–∞–º–º–∞ –∏–¥—ë—Ç –≤ –∏–Ω—Ç–µ—Ä–Ω–µ—Ç —á–µ—Ä–µ–∑ Dio.
  
- –ï—Å–ª–∏ –≤—Å—ë —Ö–æ—Ä–æ—à–æ, –æ–Ω–∞ –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç DataSuccess —Å —Ç–≤–æ–∏–º —Å–ø–∏—Å–∫–æ–º –º—É–ª—å—Ç–∏–∫–æ–≤.
  
- –ï—Å–ª–∏ –∏–Ω—Ç–µ—Ä–Ω–µ—Ç —Å–ª–æ–º–∞–ª—Å—è –∏–ª–∏ —Å–µ—Ä–≤–µ—Ä –Ω–µ –æ—Ç–≤–µ—Ç–∏–ª, –æ–Ω–∞ –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç DataFailed —Å –æ—à–∏–±–∫–æ–π.
  

---

### –ó–∞—á–µ–º –Ω–∞–º —ç—Ç–æ –Ω—É–∂–Ω–æ?

  

1. **–ß—Ç–æ–±—ã –Ω–µ –∑–∞–ø—É—Ç–∞—Ç—å—Å—è**: –ö–æ—Ä–æ–±–∫–∞ —Å—Ä–∞–∑—É –≥–æ–≤–æ—Ä–∏—Ç, –ø–æ–ª—É—á–∏–ª–æ—Å—å –∏–ª–∏ –Ω–µ—Ç. –¢—ã –Ω–µ –±—É–¥–µ—à—å –∫–æ–ø–∞—Ç—å—Å—è –≤ –ø—É—Å—Ç–æ–π –∫–æ—Ä–æ–±–∫–µ, –µ—Å–ª–∏ —Ç–∞–º –Ω–µ—Ç –∏–≥—Ä—É—à–∫–∏.
  
2. **–ß—Ç–æ–±—ã –±—ã—Ç—å –≥–æ—Ç–æ–≤—ã–º –∫–æ –≤—Å–µ–º—É**: –ü—Ä–æ–≥—Ä–∞–º–º–∞ –∑–Ω–∞–µ—Ç, —á—Ç–æ –¥–µ–ª–∞—Ç—å, –µ—Å–ª–∏ –≤—Å—ë —Ö–æ—Ä–æ—à–æ (–ø–æ–∫–∞–∑–∞—Ç—å –º—É–ª—å—Ç–∏–∫–∏), –∏ —á—Ç–æ –¥–µ–ª–∞—Ç—å, –µ—Å–ª–∏ –æ—à–∏–±–∫–∞ (—Å–∫–∞–∑–∞—Ç—å "–ü–æ–ø—Ä–æ–±—É–π –ø–æ–∑–∂–µ").
  
4. **–ß—Ç–æ–±—ã –∫–æ–¥ –±—ã–ª –∞–∫–∫—É—Ä–∞—Ç–Ω—ã–π**: –í–º–µ—Å—Ç–æ —Ç–æ–≥–æ —á—Ç–æ–±—ã –ø–∏—Å–∞—Ç—å –∫—É—á—É –ø—Ä–æ–≤–µ—Ä–æ–∫ ("–ï—Å—Ç—å –¥–∞–Ω–Ω—ã–µ? –ê –æ—à–∏–±–∫–∞?"), –º—ã –ø—Ä–æ—Å—Ç–æ —Å–º–æ—Ç—Ä–∏–º, –∫–∞–∫–∞—è –∫–æ—Ä–æ–±–∫–∞ –ø—Ä–∏—à–ª–∞ ‚Äî —Å –∏–≥—Ä—É—à–∫–æ–π –∏–ª–∏ —Å –∑–∞–ø–∏—Å–∫–æ–π.
  

---

### –ö–∞–∫ —ç—Ç–æ –≤—ã–≥–ª—è–¥–∏—Ç –≤ –∂–∏–∑–Ω–∏ (–ø—Ä–∏–º–µ—Ä)?

  

–ü—Ä–µ–¥—Å—Ç–∞–≤—å, —á—Ç–æ —Ç—ã –ø–∏—à–µ—à—å –∏–≥—Ä—É, –≥–¥–µ –Ω—É–∂–Ω–æ –∑–∞–≥—Ä—É–∑–∏—Ç—å —É—Ä–æ–≤–Ω–∏ –∏–∑ –∏–Ω—Ç–µ—Ä–Ω–µ—Ç–∞:

```dart

Future<DataState<List<String>>> fetchLevels() async {
  try {
    final response = await Dio().get('https://my-game.com/levels');
    return DataSuccess(response.data); // –£—Ä–∞, —É—Ä–æ–≤–Ω–∏ –ø—Ä–∏—à–ª–∏!
  } catch (e) {
    return DataFailed(e as DioException); // –û–π, –∏–Ω—Ç–µ—Ä–Ω–µ—Ç —Å–ª–æ–º–∞–ª—Å—è.
  }
}

void main() async {
  final result = await fetchLevels();
  if (result is DataSuccess) {
    print('–£—Ä–æ–≤–Ω–∏: ${result.data}'); // –ü–æ–∫–∞–∑—ã–≤–∞–µ–º —É—Ä–æ–≤–Ω–∏
  } else if (result is DataFailed) {
    print('–û—à–∏–±–∫–∞: ${result.error}'); // –ì–æ–≤–æ—Ä–∏–º, —á—Ç–æ –Ω–µ –ø–æ–ª—É—á–∏–ª–æ—Å—å
  }
}
```

- –ï—Å–ª–∏ —Å–µ—Ä–≤–µ—Ä –¥–∞–ª —É—Ä–æ–≤–Ω–∏, —Ç—ã –ø–æ–ª—É—á–∏—à—å DataSuccess –∏ —Å–º–æ–∂–µ—à—å –∏–≥—Ä–∞—Ç—å.
  
- –ï—Å–ª–∏ —á—Ç–æ-—Ç–æ —Å–ª–æ–º–∞–ª–æ—Å—å, –ø–æ–ª—É—á–∏—à—å DataFailed –∏ —É–≤–∏–¥–∏—à—å –æ—à–∏–±–∫—É.

### –ü–æ—á–µ–º—É –Ω–µ –ø—Ä–æ—Å—Ç–æ –¥–∞–Ω–Ω—ã–µ –∏–ª–∏ –æ—à–∏–±–∫–∞?

  

–ë–µ–∑ DataState —Ç–µ–±–µ –ø—Ä–∏—à–ª–æ—Å—å –±—ã –∫–∞–∂–¥—ã–π —Ä–∞–∑ –ø—Ä–∏–¥—É–º—ã–≤–∞—Ç—å, –∫–∞–∫ —Å–∫–∞–∑–∞—Ç—å –ø—Ä–æ–≥—Ä–∞–º–º–µ: "–¢—É—Ç –æ—à–∏–±–∫–∞!" –∏–ª–∏ "–¢—É—Ç –¥–∞–Ω–Ω—ã–µ!". –ê —Å DataState —É —Ç–µ–±—è –µ—Å—Ç—å –æ–¥–Ω–∞ —É–¥–æ–±–Ω–∞—è –∫–æ—Ä–æ–±–∫–∞, –∫–æ—Ç–æ—Ä–∞—è –≤—Å–µ–≥–¥–∞ –≥–æ–≤–æ—Ä–∏—Ç –ø—Ä–∞–≤–¥—É. –≠—Ç–æ –∫–∞–∫ –µ—Å–ª–∏ –±—ã —É —Ç–µ–±—è –±—ã–ª –≤–æ–ª—à–µ–±–Ω—ã–π —Å—É–Ω–¥—É—á–æ–∫, –∫–æ—Ç–æ—Ä—ã–π —Å–∞–º —Ä–∞—Å—Å–∫–∞–∑—ã–≤–∞–µ—Ç, —á—Ç–æ –≤–Ω—É—Ç—Ä–∏.

  

---
### –ì–ª–∞–≤–Ω–æ–µ

  

–≠—Ç–æ—Ç –∫–æ–¥ ‚Äî –∫–∞–∫ –ø–æ–º–æ—â–Ω–∏–∫, –∫–æ—Ç–æ—Ä—ã–π –¥–µ–ª–∞–µ—Ç —Ä–∞–±–æ—Ç—É —Å –∏–Ω—Ç–µ—Ä–Ω–µ—Ç–æ–º –ø—Ä–æ—â–µ –∏ –ø–æ–Ω—è—Ç–Ω–µ–µ. –û–Ω –Ω—É–∂–µ–Ω, —á—Ç–æ–±—ã –ø—Ä–æ–≥—Ä–∞–º–º–∞ –Ω–µ –ø—É—Ç–∞–ª–∞—Å—å –∏ –≤—Å–µ–≥–¥–∞ –∑–Ω–∞–ª–∞, —á—Ç–æ –¥–µ–ª–∞—Ç—å: —Ä–∞–¥–æ–≤–∞—Ç—å—Å—è –¥–∞–Ω–Ω—ã–º –∏–ª–∏ —á–∏–Ω–∏—Ç—å –æ—à–∏–±–∫–∏. –ò—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –≤ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è—Ö, –≥–¥–µ –¥–∞–Ω–Ω—ã–µ –ø—Ä–∏—Ö–æ–¥—è—Ç –∏–∑ –∏–Ω—Ç–µ—Ä–Ω–µ—Ç–∞, —á—Ç–æ–±—ã –≤—Å—ë –±—ã–ª–æ —á—ë—Ç–∫–æ –∏ –∫—Ä–∞—Å–∏–≤–æ!





---
# References

[Refactory.guru - state](https://refactoring.guru/ru/design-patterns/state)